# User queries
query GetCurrentUser @auth(level: USER) {
  user(key: {id_expr: "auth.uid"}) {
    id
    email
    display_name
    photo_url
    created_at
    updated_at
  }
}

query GetUser($id: String!) @auth(level: USER) {
  user(key: {id: $id}) {
    id
    email
    display_name
    photo_url
    created_at
    updated_at
  }
}

query GetUserProfiles @auth(level: USER) {
  profiles(where: {user_id: {eq_expr: "auth.uid"}}) {
    id
    user_id
    name
    bio
    avatar_url
    skills
    interests
    is_default
    created_at
    updated_at
  }
}

# Workspace queries
query GetUserWorkspaces @auth(level: USER) {
  workspace_members(where: {user_id: {eq_expr: "auth.uid"}}) {
    workspace {
      id
      name
      description
      logo_url
      created_by
      created_at
      updated_at
    }
  }
}

query GetWorkspace($id: UUID!) @auth(level: USER) {
  workspace(key: {id: $id}) {
    id
    name
    description
    logo_url
    created_by
    created_at
    updated_at
  }
}

query GetWorkspaceMembers($workspaceId: UUID!) @auth(level: USER) {
  workspace_members(where: {workspace_id: {eq: $workspaceId}}) {
    workspace_id
    user_id
    profile_id
    role
    joined_at
    user {
      id
      email
      display_name
      photo_url
    }
    profile {
      id
      name
      avatar_url
    }
  }
}

query GetBusinessProfile($workspaceId: UUID!) @auth(level: USER) {
  business_profile(key: {workspace_id: $workspaceId}) {
    id
    workspace_id
    name
    industry
    description
    location
    website
    employee_count
    created_at
    updated_at
  }
}

query GetPartnerPreferences($workspaceId: UUID!) @auth(level: USER) {
  partner_preferences(key: {workspace_id: $workspaceId}) {
    id
    workspace_id
    industries
    locations
    min_employee_count
    max_employee_count
    skills_needed
    created_at
    updated_at
  }
}

query GetWorkspaceInvitations($workspaceId: UUID!) @auth(level: USER) {
  workspace_invitations(where: {workspace_id: {eq: $workspaceId}}) {
    id
    workspace_id
    email
    role
    invited_by
    status
    created_at
    expires_at
  }
}

query GetPendingInvitationsByEmail($email: String!) @auth(level: USER) {
  workspace_invitations(where: {
    _and: [
      {email: {eq: $email}},
      {status: {eq: "pending"}}
    ]
  }) {
    id
    workspace_id
    email
    role
    invited_by
    status
    created_at
    expires_at
    workspace {
      id
      name
      logo_url
    }
  }
}
